{
    "MSI": {
        "Guid": "2F142293-C7B5-4C57-8FFE-75F636688C9E"
    },

    "Install": {
      "Pages": [
        {
          "architectureDiagram": "dist/Apps/Microsoft/Released/Microsoft-CRMSalesManagement/Web/Images/crm-sales-management.png",
          "displayname": "Getting Started",
          "list1": [
            "$translate(INIT_GETTING_STARTED_AZURE_SUBSCRIPTION)",
            "$translate(INIT_GETTING_STARTED_PBI_DESKTOP)",
            "$translate(INIT_GETTING_STARTED_PBI_PRO)"
          ],
          "list2": [
            "$translate(INIT_GETTING_STARTED_CONNECT_AS_PBI)"
          ],
          "name": "$SiteCommon$/pages-gallery/getting-started.html",
          "subtitle": "$translate(INIT_AAL_SUBTITLE)",
          "templateName": "$translate(INIT_AAL_TITLE)"
        },
        {
          "defaultLocation": "5",
          "displayname": "Login",
          "name": "$SiteCommon$/pages-gallery/azure-login.html",
          "pricingCalculatorUrl": "$translate(INIT_NEWS_PRICING_CALCULATOR)",
          "pricingCost": "$translate(INIT_AAL_PRICING_COST)",
          "pricingUrl": "$translate(INIT_NEWS_PRICING_URL)"
        },
        {
          "displayname": "Source",
          "isAzureSql": true,
          "name": "$SiteCommon$/pages-gallery/sql.html",
          "newSqlDatabase": "activityLogDB",
          "showAzureSql": false,
          "showNewSqlOption": "true",
          "sqlInstance": "NewSql",
          "subtitle": "$translate(INIT_SQL_SUBTITLE_AAL)",
          "title": "$translate(INIT_SQL_TITLE)"
        },
        {
                "displayname": "Summary",
                "name": "$SiteCommon$/pages-gallery/summary.html",
                "values": {
                    "Target Server": "$(this.MS.DataStore.getValue('Server'))",
                    "Target Database": "$(this.MS.DataStore.getValue('Database'))",
                    "Target Username": "$(this.MS.DataStore.getValue('Username'))"
                }
            },
            {
                "datastoreEntriesToValidate": [
                    "AzureToken",
                    "SqlConnectionString"
                ],
                "displayname": "Deploy",
                "downloadPbiText": "$translate(INIT_AAL_DOWNLOAD)",
                "enablePublishReport": true,
                "filename": "$save('ActivityLogTemplate.pbix')",
                "name": "$SiteCommon$/pages-gallery/progress.html",
                "uniqueId": "$save(this.MS.UtilityService.getUniqueId(8))"
            }
      ],

      "Actions": [
        {
          "displayname": "$translate(INIT_ACTION_DEPLOYING_SQL_SCRIPTS)",
          "name": "Microsoft-DeploySQLScripts",
          "SqlServerIndex": "0",
          "SqlScriptsFolder": "Database"
        },
        {
          "displayname": "$translate(INIT_ACTION_CREATING_EVENT_HUB)",
          "name": "Microsoft-CreateEventHubNameSpace"
        },
        {
          "displayname": "$translate(INIT_ACTION_EXPORT_ACTIVITY_LOG)",
          "name": "Microsoft-ExportActivityLogToEventHub"
        },
        {
          "displayname": "$translate(INIT_ACTION_CREATING_STREAM_ANALYTICS_JOB)",
          "name": "Microsoft-CreateStreamAnalyticsJob"
        },
        {
          "displayname": "$translate(INIT_ACTION_CONFIGURING_STREAM_ANALYTICS_INPUT)",
          "name": "Microsoft-SetStreamAnalyticsInputAsEventHub"
        },
        {
          "displayname": "$translate(INIT_ACTION_CONFIGURING_STREAM_ANALYTICS_OUTPUT)",
          "name": "Microsoft-SetOutputAsSQL"
        },
        {
          "displayname": "$translate(INIT_ACTION_CONFIGURING_STREAM_ANALYTICS_QUERY)",
          "name": "Microsoft-SetStreamAnalyticsQuery"
        },
        {
          "displayname": "$translate(INIT_ACTION_GET_HISTORICAL_ACTIVITY_LOG_DATA)",
          "name": "Microsoft-GetHistoricalData"
        },
        {
          "displayname": "$translate(INIT_ACTION_DEPLOYING_STREAM_ANALYTICS)",
          "name": "Microsoft-StartStreamAnalyticsJob"
        }
      ]
    },

    "Uninstall": {
        "Pages": [
            {
                "displayname": "Uninstall Progress",
                "HasNavigated": "$save(true)",
                "isUninstall": true,
                "name": "$SiteCommon$/pages-gallery/progress.html",
                "successMessage": "$translate(INIT_UNINSTALL_SUCCESS)"
            }
        ],
        "Actions": [
            {
                "displayname": "$translate(INIT_ACTION_REMOVING_FILES)",
                "name": "Microsoft-RemoveFiles"
            },
            {
                "displayname": "$translate(INIT_ACTION_FINISHING_CLEANUP)",
                "name": "Microsoft-RemoveFiles",
                "TargetPath": "C:\\Program Files\\Microsoft Templates\\Microsoft-CRMSalesManagement\\Apps\\Microsoft\\Released\\Microsoft-CRMSalesManagement\\Temp"
            }
        ]
    }
}
{
  "MSI": {
    "Guid": "88DC5CAB-D05D-4193-A432-30A09138D26D"
  },

  "Install": {
    "Pages": [
      {
        "displayname": "Getting Started",
        "architectureDiagram": "dist/Apps/Microsoft/Released/Microsoft-SCCM2/Web/Images/SCCMArchitectureDiagram.png",
        "isDownload": "$(!this.MS.HttpService.isOnPremise)",
        "list1": [
          "System Center 2012 Configuration Manager R2 SP1 or later. Read access to System Center Configuration Manager database is required.",
          "Destination database: Azure SQL database or SQL Server database (SQL Server 2008 R2 SP3 or later).",
          "For the machine where the installation is run, Microsoft .NET Framework 4.5 or later & PowerShell version 5.0 or later.",
          "Power BI Desktop (latest version)",
          "Power BI Pro (to share the template with your organization)"
        ],
        "list2": [
          "Scalable and extensible solution with minimum set up and maintenance considerations",
          "Data pulled daily from System Center Configuration Manager & stored in a SQL database optimized for reporting",
          "Import data into powerful Power BI reports"
        ],
        "name": "$SiteCommon$/pages-gallery/getting-started.html",
        "subtitle": "Welcome to the System Center Configuration Manager solution template.",
        "templateName": "System Center Configuration Manager"
      },
      {
        "displayname": "Login",
        "onValidate": [
          {
            "name": "Microsoft-ValidateAdminPrivileges"
          },
          {
            "name": "Microsoft-ValidateSecurityOptions"
          },
          {
            "name": "Microsoft-ValidatePowerShellVersion"
          }
        ],
        "name": "$SiteCommon$/pages-gallery/windows-auth.html",
        "subtitle": "Specify your windows credentials to create a recurring schedule. The credentials you specify will be used to also connect to the SCCM database"
      },
      {
        "credentialTarget": "pbi_sccm",
        "displayname": "Source",
        "hideSqlAuth": true,
        "name": "$SiteCommon$/pages-gallery/sql-server.html",
        "onNext": [
          {
            "name": "Microsoft-CheckSCCMVersion",
            "useImpersonation": true
          }
        ],
        "showAllWriteableDatabases": false,
        "showAzureSql": false,
        "subtitle": "Set up a connection to your SCCM database so we can bring in your data.",
        "title": "Connect to your System Center Configuration Manager database",
        "useImpersonation": true
      },
      {
        "checkSqlVersion": true,
        "credentialTarget": "pbi_sccm",
        "displayname": "Target",
        "name": "$SiteCommon$/pages-gallery/sql-server.html",
        "onNext": [
          {
            "name": "Microsoft-CheckSQLVersion",
            "useImpersonation": true
          },
          {
            "name": "Microsoft-CompareSqlLCIDs",
            "useImpersonation": true
          }
        ],
        "showSqlRecoveryModeHint": true,
        "subtitle": "Set up a connection to your target database so we can transfer your data.",
        "title": "Connect to your SQL database",
        "useImpersonation": true
      },
      {
        "displayname": "Customize",
        "name": "customize.html"
      },
      {
        "displayname": "Summary",
        "name": "$SiteCommon$/pages-gallery/summary.html",
        "values": {
          "Target Server": "$(this.MS.DataStore.getValue('Server'))",
          "Target Database": "$(this.MS.DataStore.getValue('Database'))",
          "Target Username": "$(this.MS.DataStore.getValue('Username'))"
        }
      },
      {
        "displayname": "Progress",
        "filename": "$save('SCCMSolutionTemplate2.pbix')",
        "finishedActionName": "Microsoft-GetTaskStatus",
        "name": "$SiteCommon$/pages-gallery/progress.html",
        "showCounts": true,
        "showEmailSubmission": false,
        "sqlServerIndex": 1,
        "targetSchema": "pbist_sccm"
      }
    ],

    "Actions": [
      {
        "displayname": "Deploy DB scripts",
        "name": "Microsoft-DeploySQLScripts",
        "SqlScriptsFolder": "Service/Database/NoETL",
        "SqlServerIndex": "1",
        "useImpersonation": true
      },
      {
        "displayname": "Deploy DB Configuration",
        "name": "Microsoft-SetConfigValueInSql",
        "SqlConfigTable": "pbist_sccm.[configuration]",
        "SqlServerIndex": "1",
        "useImpersonation": true
      },
      {
        "displayname": "Installing SQL Tools",
        "name": "Microsoft-InstallSqlTools"
      },
      {
        "displayname": "Copy dataload scripts",
        "name": "Microsoft-InstallSCCM"
      },
      {
        "displayname": "Grant permission for logging as a batch job",
        "name": "Microsoft-AddLogonAsBatchPermission"
      },
      {
        "displayname": "Schedule tasks",
        "name": "Microsoft-CreateTask"
      },
      {
        "displayname": "Run tasks",
        "name": "Microsoft-RunTask"
      },
      {
        "displayname": "Waiting for data to come in",
        "FinishedActionName": "Microsoft-GetTaskStatus",
        "IsWaiting": true,
        "name": "Microsoft-GetDataPullStatus",
        "SqlServerIndex": 1,
        "TargetSchema": "pbist_sccm",
        "useImpersonation": true
      }
    ]
  },

  "Uninstall": {
    "Pages": [
      {
        "architectureDiagram": "dist/Apps/Microsoft/Released/Microsoft-SCCM2/Web/Images/SCCMArchitectureDiagram.png",
        "displayname": "Uninstall",
        "isDownload": "$(!this.MS.HttpService.isOnPremise)",
        "name": "$SiteCommon$/pages-gallery/uninstall.html",
        "templateName": "System Center Configuration Manager",
        "uninstallList": [
          "The task used to move data between the SCCM database and the target database",
          "The scripts used to create the initial tables in the target database"
        ]
      },
      {
        "displayname": "Uninstall Progress",
        "isUninstall": true,
        "name": "$SiteCommon$/pages-gallery/progress.html",
        "showEmailSubmission": false,
        "successMessage": "Uninstall complete"
      }
    ],

    "Actions": [
      {
        "displayname": "Remove task",
        "name": "Microsoft-RemoveTask",
        "TaskName": "Power BI Solution Template - SCCM"
      },
      {
        "displayname": "Remove files",
        "name": "Microsoft-RemoveFiles"
      },
      {
        "displayname": "Finishing cleanup",
        "name": "Microsoft-RemoveFiles",
        "TargetPath": "C:\\Program Files\\Microsoft Templates\\Microsoft-SCCM2\\Apps\\Microsoft\\Released\\Microsoft-SCCM2\\Temp"
      }
    ]
  }
}